
@{
    Layout = null;// "~/Views/Shared/_Admin.cshtml";
}
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/Print/PrintPreview.css" rel="stylesheet" />
<link href="~/Content/Print/modal.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700" rel="stylesheet" />


<div class="container">
    <div class="row">
        <div class="col-12">
            <div class="card card-primary card-outline">
                <div class="card-header">
                    <h3 class="card-title" style="margin-top:10px;">
                        <button type="button" class="btn btn-success" id="AddBtn1">Print Invoice</button>

                    </h3>
                </div>

                <div class="card-body">

                    <table id="myTable" class="table table-bordered table-hover">
                        <thead>
                            <tr role="row">
                                <th></th>
                                <th>Invoice Number</th>
                                <th>Status</th>
                                <th>Invoice Date</th>
                                <th>Ticket Number</th>
                                <th>Description</th>
                                <th>Routing</th>
                                <th>Departure Date</th>
                                <th>Arrival Date</th>
                                <th>Paid</th>
                                <th>Invoice Amount</th>
                                <th>Base Fare</th>
                                <th>Tax</th>
                                <th>Other Cost</th>
                                <th>Net Payable</th>
                            </tr>
                        </thead>
                        <tbody id="tblbody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>



<div class="modal " id="printModal" data-keyboard="false" data-backdrop="static" style="">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background-color: rgba(0,0,0,0.85);">
            <div class="modal-header">
                <h4 class="modal-title">Print Preview</h4>
                <a onclick="printButton()" style="cursor: pointer; font-weight: bold; padding: 10px; position: absolute; top: 2px; right: 36px; z-index: 100; color: #fff;" href="javascript:0"><i class="fas fa-print"></i> Print</a>
                <label for="mpo-modal-controller" class="mpo-modal-close" data-dismiss="modal">&times;</label>
            </div>
            <div class="modal-body">
                <div id="table-wrapper">
                    <div id="table-scroll">
                        <div style="background-color: #fff;padding:5px; border-radius:5px;">
                            <div id="printArea">
                                <div id="invoice">
                                    <div class="invoice overflow-auto">
                                        <div style="min-width: 600px">
                                            <header id="header">
                                                <div class="row">
                                                    <div class="col col-xs-8">
                                                        <a><img src="~/Logo/logo.png" data-holder-rendered="true" /></a>
                                                        <div>N 1781, Sur O’avenue Kapenda, Quarter Makutano, Commune et Ville de Lubumbashi</div>
                                                    </div>
                                                    <div class="col col-xs-4 company-details">
                                                        <div class="date"><b>Invoice Date:</b> 10-Apr-2021</div>
                                                    </div>
                                                </div>
                                            </header>
                                            <main>
                                                <div class="row contacts">
                                                    <div class="col-sm-8 invoice-to">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <div class="text-gray-light"><b>BILL TO:</b></div>
                                                            </div>
                                                            <div class="col-sm-9">
                                                                <div class="text-gray-light"><b>S.Z.C</b></div>
                                                            </div>
                                                            <div class="col-sm-3">
                                                                <div class="text-gray-light">Customer Name:</div>
                                                            </div>
                                                            <div class="col-sm-9">
                                                                PAN ZHIGANG
                                                            </div>
                                                            <div class="col-sm-3">
                                                                <div class="text-gray-light">Address:</div>
                                                            </div>
                                                            <div class="col-sm-9">
                                                                Route Kambove, Quartier KAKONTWE, Commune De Panda
                                                            </div>
                                                            <div class="col-sm-3">
                                                                <div class="text-gray-light">City:</div>
                                                            </div>
                                                            <div class="col-sm-9">
                                                                Likasi
                                                            </div>
                                                            <div class="col-sm-3">
                                                                <div class="text-gray-light">Phone:</div>
                                                            </div>
                                                            <div class="col-sm-9">
                                                                +243823339330
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-4 invoice-details">
                                                        <div class="row">
                                                            <div class="col-sm-6">
                                                                <b>INVOICE#</b>
                                                            </div>
                                                            <div class="col-sm-6" style="text-align: left;">
                                                                <h5 class="invoice-id">1212257</h5>
                                                            </div>
                                                            <div class="col-sm-6">
                                                                <b>Cust Code:</b>
                                                            </div>
                                                            <div class="col-sm-6" style="text-align: left;">
                                                                S.Z.C
                                                            </div>
                                                            <div class="col-sm-6">
                                                                <b>Ref#</b>
                                                            </div>
                                                            <div class="col-sm-6" style="text-align: left;">

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <thead>
                                                        <tr>
                                                            <th>Date of Issuance</th>
                                                            <th class="text-left">Description</th>
                                                            <th class="text-right">Ticket Number</th>
                                                            <th class="text-right">TOTAL</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td class="no">10-Apr-2021</td>
                                                            <td class="text-left"><h3>Website Design</h3>Creating a recognizable design solution based on the company's existing visual identity</td>
                                                            <td class="unit">1234</td>
                                                            <td class="total">$10.00</td>
                                                        </tr>
                                                        <tr>
                                                            <td class="no">13-Apr-2021</td>
                                                            <td class="text-left"><h3>Website Design</h3>Creating a recognizable design solution based on the company's existing visual identity</td>
                                                            <td class="unit">0989</td>
                                                            <td class="total">$1,200.00</td>
                                                        </tr>
                                                    </tbody>
                                                    <tfoot>
                                                        <tr>
                                                            <td colspan="2"></td>
                                                            <td>SUBTOTAL</td>
                                                            <td>$1,210.00</td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2"></td>
                                                            <td>TAX 25%</td>
                                                            <td>$1,300.00</td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2"></td>
                                                            <td>GRAND TOTAL</td>
                                                            <td>$6,500.00</td>
                                                        </tr>
                                                    </tfoot>
                                                </table>
                                                <div class="thanks">
                                                    <div class="notices">
                                                        <div class="notice">Thank you for your business!</div>
                                                    </div>
                                                </div>
                                            </main>
                                            <footer>
                                                Invoice was created on a computer and is valid without the signature and seal.
                                            </footer>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>


<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>



<script type="text/javascript">

    $("#AddBtn1").click(function () {
        $("#printModal").modal('show');
    });

    function printButton() {
        let htmlToPrint = $("#invoice").html();

        var doPrint = '';
        let printHTML = "";
        printHTML = (document.getElementById("invoice")).innerHTML;

        var display_setting = "toolbar=yes, location=no, direction=yes, menubar=yes,";
        display_setting += "scrollbar=yes, width=850, height=800, left=50";
        doPrint = window.open("", "", display_setting);
        doPrint.document.open();
        doPrint.document.write('<html><head>');
        doPrint.document.write("<title>Invoice</title>");
        doPrint.document.write('<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" media="print" />');
        doPrint.document.write("<style>*{font-size:13px;}#invoice {padding:10px 20px;}.invoice {position: relative;background-color: #FFF;min-height: 680px;}header {padding: 10px 0;margin-bottom: 20px;border-bottom: 2px solid #3989c6}.contacts {margin-bottom: 20px}.invoice-to {text-align: left}.invoice-details {text-align: right}.invoice-id {margin-top: 0;color: #3989c6}main {padding-bottom: 20px}.thanks {margin-top: -100px;font-size: 2em;margin-bottom: 50px}.notices {padding-left: 6px;border-left: 6px solid #3989c6}.notice {font-size: 13px}table {width: 100%;border-collapse: collapse;border-spacing: 0;margin-bottom: 20px; }table td , table  th {padding: 15px;background: #eee;border-bottom: 1px solid #fff}table  th {white-space: nowrap;font-weight: 400;font-size: 16px}table  td h3 {margin: 0;font-weight: 400;color: #3989c6;font-size: 1.2em  }table  .qty,  table .total, table  .unit {text-align: right;font-size: 1.2em}table  .no {color: #fff;font-size: 1.6em;background: #3989c6}table .unit {background: #ddd}table  .total {background: #3989c6;color: #fff}table tbody tr:last-child td {border: none}table tfoot td {background: 0 0;border-bottom: none;white-space: nowrap;text-align: right;padding: 10px 20px;font-size: 1.2em;border-top: 1px solid #aaa}table tfoot tr:first-child td {border-top: none}table tfoot tr:last-child td {color: #3989c6;font-size: 1.4em;border-top: 1px solid #3989c6;}table tfoot tr td:first-child {border: none}footer {width: 100%;text-align: center;color: #777;border-top: 1px solid #aaa;padding: 8px 0}body{-webkit-print-color-adjust:exact;}</style>");
        doPrint.document.write('<link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700" rel="stylesheet" />');
        doPrint.document.write('</head><body  onLoad="self.print(); self.close(); " ');
        doPrint.document.write(printHTML);
        doPrint.document.write("</body></html>");
        doPrint.document.close();


    }

    $(document).keydown(function (event) {
        if (event.ctrlKey == true && (event.which == '80')) { //cntrl + p
            event.preventDefault();
            printAssessment();
        }
    });

    function printAssessment() {
        printButton();
    }
</script>



