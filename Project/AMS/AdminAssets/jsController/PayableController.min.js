function tableToExcel(t, e) { $("table tfoot").empty(), $("table > tfoot").append("<tr><th></th><th></th><th></th><th></th><th></th><th>" + asif[0] + "</th><th>" + asif[1] + "</th><th>" + asif[2] + "</th><th></th></tr>"); t.nodeType || (t = document.getElementById(t)); var a, l, o = { worksheet: e || "Worksheet", table: t.innerHTML }, t = document.createElement("a"); t.href = "data:application/vnd.ms-excel;base64," + (l = o, a = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>'.replace(/{(\w+)}/g, function (t, e) { return l[e] }), window.btoa(unescape(encodeURIComponent(a)))), t.download = e + ".xls", t.click() } function changePayableCodeAndStatus() { var t = $("#Air_ID").val(), e = $("#Pay_Status").val(); $("#myTable").DataTable().destroy(), $("table tbody").empty(), $("table thead").empty(), $("table tfoot").empty(), $("table thead").append("<tr ><th>Invoice Number</th><th>Invoice Date</th><th>Ticket Number</th><th>Description</th><th>Routing</th><th>Net Payable</th><th>Paid2</th><th>Balance</th><th>Payable Code</th></tr>"), $("table tfoot").append("<tr><th>Invoice Number</th><th>Invoice Date</th><th>Ticket Number</th><th>Description</th><th>Routing</th><th>Net Payable</th><th>Paid2</th><th>Balance</th><th>Payable Code</th></tr>"), $.ajax({ type: "GET", url: "/Payable/GetPayableByPCodeByDate", data: { pCode: t, pStatus: e }, success: OnSuccess, failure: function (t) { alert(t.d) }, error: function (t) { alert(t.d) } }), $("#myTable tfoot th").each(function (t) { var e = $(this).text(); "Balance" != e && "Paid2" != e && "Net Payable" != e && "Routing" != e && "Description" != e && ($(this).html('<input style="width:150px;" type="text" class="form-control" placeholder="Search ' + e + '" />'), $("input", this).on("keyup change clear", function () { table.column(t).search() !== this.value && table.column(t).search(this.value).draw() })) }), $(".select2").val(null).trigger("change") } function viewReport() { var t = $("#reservation").val(), e = t.substring(0, 10), a = t.substring(13), l = $("#Air_ID").val(), o = $("#Pay_Status").val(); $("#myTable").DataTable().destroy(), $("table tbody").empty(), $("table thead").empty(), $("table tfoot").empty(), $("table thead").append("<tr ><th>Invoice Number</th><th>Invoice Date</th><th>Ticket Number</th><th>Description</th><th>Routing</th><th>Net Payable</th><th>Paid2</th><th>Balance</th><th>Payable Code</th></tr>"), $("table tfoot").append("<tr><th>Invoice Number</th><th>Invoice Date</th><th>Ticket Number</th><th>Description</th><th>Routing</th><th>Net Payable</th><th>Paid2</th><th>Balance</th><th>Payable Code</th></tr>"), "" != l && null != o && "" != t ? ($.ajax({ type: "GET", url: "/Payable/GetPayableByPCodeByDate", data: { pCode: l, pStatus: o, Dfrom: e, Dto: a }, success: OnSuccess, failure: function (t) { alert(t.d) }, error: function (t) { alert(t.d) } }), $("#myTable tfoot th").each(function (t) { var e = $(this).text(); "Balance" != e && "Paid2" != e && "Net Payable" != e && "Routing" != e && "Description" != e && ($(this).html('<input style="width:150px;" type="text" class="form-control" placeholder="Search ' + e + '" />'), $("input", this).on("keyup change clear", function () { table.column(t).search() !== this.value && table.column(t).search(this.value).draw() })) }), $(".select2").val(null).trigger("change")) : swal("Info!", "Select Payable Code & Status", "info") } var table; function myDatatable() { $.ajax({ type: "GET", url: "/Payable/GetPayable", data: { Dfrom: null, Dto: null }, contentType: "application/json; charset=utf-8", dataType: "json", success: OnSuccess, failure: function (t) { alert(t.d) }, error: function (t) { alert(t.d) } }), $("#myTable tfoot th").each(function (t) { var e = $(this).text(); "Balance" != e && "Paid2" != e && "Net Payable" != e && "Routing" != e && "Description" != e && ($(this).html('<input style="width:150px;" type="text" class="form-control" placeholder="Search ' + e + '" />'), $("input", this).on("keyup change clear", function () { table.column(t).search() !== this.value && table.column(t).search(this.value).draw() })) }) } function OnSuccess(t) { var e; 1 == t.success ? (table = $("#myTable").DataTable({ lengthMenu: [[20, 25, 50], [20, 25, 50]], orderCellsTop: !0, fixedHeader: !0, scrollCollapse: !0, paging: !1, scrollX: !0, select: !0, scrollY: "50vh", processing: !0, data: t.CashBook, columns: [{ data: "Invoice_Number" }, { title: "Invoice Date", data: "Invoice_Date", render: function (t) { return null == t ? "" : moment(t).format("DD/MMM/YYYY") } }, { data: "Ticket_Number" }, { data: "Description" }, { data: "Routing" }, { data: "Net_Payable" }, { data: "Paid2" }, { data: "Balance" }, { data: "Payable_Code" }], initComplete: function () { count = 0, this.api().columns([3, 4, 8]).every(function () { var t = this.header(), t = $(t).html().replace(/[\W]/g, "-"), e = this, a = $('<select style="width:100%" id="' + t + '" class="select2" ></select>').appendTo($(e.footer()).empty()).on("change", function () { var t = $.map($(this).select2("data"), function (t, e) { return t.text ? "^" + $.fn.dataTable.util.escapeRegex(t.text) + "$" : null }); 0 === t.length && (t = [""]); t = t.join("|"); e.search(t || "", !0, !1).draw() }); e.data().unique().sort().each(function (t, e) { a.append('<option value="' + t + '">' + t + "</option>") }), $("#" + t).select2({ multiple: !0, closeOnSelect: !1, placeholder: "Select a " + t }), $(".select2").val(null).trigger("change") }) }, columnDefs: [{ targets: 0, type: "date", width: "100px" }, { width: "120px", targets: [3] }, { width: "120px", targets: [4] }, { width: "120px", targets: [8] }], footerCallback: function (t, e, a, l, o) { var n = this.api(); asif = []; function r(t) { return "string" == typeof t ? +t.replace(/[\$,]/g, "") : "number" == typeof t ? t : 0 } amount = n.column(5, { page: "current" }).data().reduce(function (t, e) { return r(t) + r(e) }, 0), asif.push(amount.toFixed(2)), $(n.column(5).footer()).html("$ " + amount.toFixed(2)), paid = n.column(6, { page: "current" }).data().reduce(function (t, e) { return r(t) + r(e) }, 0), asif.push(paid.toFixed(2)), $(n.column(6).footer()).html("$ " + paid.toFixed(2)), balance = n.column(7, { page: "current" }).data().reduce(function (t, e) { return r(t) + r(e) }, 0), asif.push(balance.toFixed(2)), $(n.column(7).footer()).html("$ " + balance.toFixed(2)) }, language: { search: "", lengthMenu: "Select _MENU_ ", zeroRecords: "No <b>Cash Book</b> Data Found", infoEmpty: "No Records Available", infoFiltered: "(filtered from _MAX_ total records)" } }), $(".dataTables_filter input").attr("placeholder", "Search Payable"), $(".dataTables_filter input").addClass("form-control"), $('<tr><th colspan="9" style="text-align:center; font-size:20pt; background: #748db9; color: #ff0000;"><label>STATEMENT OF ACCOUNT - PAYABLE</label></th>NaN').insertBefore("table > thead > tr:first"), $('<tr><th></th><th></th><th></th><th></th><th></th><th><label>Statement Date</label></th><th colspan="2"><label id="todayDate"></label></th>NaN').insertBefore("table > thead > tr:first"), $('<tr><th colspan="5">Address: N 1781, Sur O’avenue Kapenda, Quarter Makutano, Commune et Ville de Lubumbashi</th><th></th><th colspan="3"><label>Email: admin@brillanttravel.com</label></th>NaN').insertBefore("table > thead > tr:first"), $('<tr><th colspan="8" style="height:60px"><img src="http://erpadmin.brillanttravel.com/Logo/logo.png" /></th>NaN').insertBefore("table > thead > tr:first"), $("#todayDate").text(toDayDate())) : ($("#myTable").DataTable({ bLengthChange: !1, orderCellsTop: !0, fixedHeader: !0, scrollCollapse: !0, searching: !1, scrollX: !0, scrollY: "50vh", processing: !0, bDestroy: !0, paging: !1, info: !1 }), e = $("#reservation").val(), swal("INFO!", t.message + " for " + e, "info")) } function toDayDate() { var t = new Date; return t.getDate() + "/" + ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"][t.getMonth()] + "/" + t.getFullYear() } $("#reservation").daterangepicker(), $(".select2").select2({ theme: "bootstrap4" }), $(document).ready(function () { }); var asif = [];