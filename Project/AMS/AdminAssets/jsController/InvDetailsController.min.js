var table; function viewReport() { var e = $("#reservation").val(), t = e.substring(0, 10), a = e.substring(13), e = $("#Pay_Status").val(); $("#myTable").DataTable().destroy(), $("table tbody").empty(), $.ajax({ type: "POST", url: "/GenerateInvoice/GetInvoiceDetailsReport", data: { Dfrom: t, Dto: a, Pay_Status: e }, beforeSend: function () { swal({ title: " ", text: "Please Wait", imageUrl: "/AdminAssets/Images/ajax-Load.gif", showCancelButton: !1, showConfirmButton: !1 }) }, success: OnSuccess, failure: function (e) { alert(e.d) }, error: function (e) { alert(e.d) } }), $("#myTable tfoot th").each(function (e) { var t = $(this).text(); "Cust Code" != t && "Payable Code" != t && "Payable Supplier" != t && "Agent Name" != t && "Ticket Class" != t && ($(this).html('<input style="width:150px;" type="text" class="form-control" placeholder="Search ' + t + '" />'), $("input", this).on("keyup change clear", function () { table.column(e).search() !== this.value && table.column(e).search(this.value).draw() })) }), $(".select2").val(null).trigger("change") } function myDatatable() { $.ajax({ type: "POST", url: "/GenerateInvoice/GetInvoiceDetailsReport", data: "{}", contentType: "application/json; charset=utf-8", dataType: "json", beforeSend: function () { swal({ title: " ", text: "Please Wait", imageUrl: "/AdminAssets/Images/ajax-Load.gif", showCancelButton: !1, showConfirmButton: !1 }) }, success: OnSuccess, failure: function (e) { alert(e.d) }, error: function (e) { alert(e.d) } }), $("#myTable tfoot th").each(function (e) { var t = $(this).text(); "Cust Code" != t && "Payable Code" != t && "Payable Supplier" != t && "Agent Name" != t && "Ticket Class" != t && ($(this).html('<input style="width:150px;" type="text" class="form-control" placeholder="Search ' + t + '" />'), $("input", this).on("keyup change clear", function () { table.column(e).search() !== this.value && table.column(e).search(this.value).draw() })) }) } function OnSuccess(e) { var t; 1 == e.success ? (setTimeout(function () { swal.close() }, 1500), table = $("#myTable").DataTable({ lengthMenu: [[20, 25, 50,300], [20, 25, 50,300]], orderCellsTop: !0, fixedHeader: !0, scrollCollapse: !0, scrollX: !0, select: !0, scrollY: "50vh", processing: !0, data: e.data, columns: [{ data: "Invoice_Number", width: "200px" }, { data: "ReceivePay_Status", render: function (e, t, a, n) { return "1" == a.ReceivePay_Status && "1" == a.Pay_Status && "01" == a.Ticket_Status ? '<label class="badge bg-success">Complete</label>' : "1" == a.ReceivePay_Status && "1" == a.Pay_Status && "03" == a.Ticket_Status ? '<label class="badge bg-info">Refund/Complete</label>' : "1" == a.ReceivePay_Status && "1" == a.Pay_Status && "02" == a.Ticket_Status ? '<label class="badge bg-info">Exchange</label>' : "1" != a.ReceivePay_Status && "1" != a.Pay_Status ? '<label class="badge bg-danger">Pending</label>' : "1" == a.ReceivePay_Status && "1" != a.Pay_Status ? '<label class="badge bg-danger">Not Paid</label>' : "1" != a.ReceivePay_Status && "1" == a.Pay_Status ? '<label class="badge bg-danger">Not Received</label>' : "-" } }, { title: "Invoice Date", width: "200px", data: "Invoice_Date", render: function (e) { return null == e ? "" : moment(e).format("DD/MMM/YYYY") } }, { data: "Ticket_Number", width: "200px" }, { data: "Description", width: "200px" }, { data: "Routing", width: "200px" }, { title: "Departure Date", width: "200px", data: "Departure_Date", render: function (e) { return null == e ? "" : moment(e).format("DD/MMM/YYYY") } }, { title: "Arrival Date", width: "200px", data: "Arrival_Date", render: function (e) { return null == e ? "" : moment(e).format("DD/MMM/YYYY") } }, { data: "Paid", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Invoice_Amount", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Base_Fare", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Tax", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Other_Cost", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "AirLine_Penalty", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Customer_Penalty", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Net_Payable", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Paid2", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Other_Ref", width: "200px" }, { data: "Cust_Code", width: "200px" }, { data: "Payable_Code", width: "100px" }, { data: "Payable_Supplier", width: "200px" }, { data: "Agent_Name", width: "200px" }, { data: "Ticket_Commission", width: "200px" }, { data: "Commission_Amount", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "VAT", width: "200px" }, { data: "VAT_Amount", width: "200px" }, { data: "Ticket_Class", width: "200px" }], initComplete: function () { count = 0, this.api().columns([18, 19, 20, 21, 26]).every(function () { var e = this.header(), e = $(e).html().replace(/[\W]/g, "-"), t = this, a = $('<select style="width:100%" id="' + e + '" class="select2" ></select>').appendTo($(t.footer()).empty()).on("change", function () { var e = $.map($(this).select2("data"), function (e, t) { return e.text ? "^" + $.fn.dataTable.util.escapeRegex(e.text) + "$" : null }); 0 === e.length && (e = [""]); e = e.join("|"); t.search(e || "", !0, !1).draw() }); t.data().unique().sort().each(function (e, t) { a.append('<option value="' + e + '">' + e + "</option>") }), $("#" + e).select2({ multiple: !0, closeOnSelect: !1, placeholder: "Select a " + e }), $(".select2").val(null).trigger("change") }) }, language: { search: "", lengthMenu: "Select _MENU_ ", zeroRecords: "No <b>Invoice Details</b> Data Found", infoEmpty: "No Records Available", infoFiltered: "(filtered from _MAX_ total records)" }, dom: "lBfrtip", buttons: [{ extend: "copyHtml5", title: "Unpaid Invoice Report" }, { extend: "csvHtml5", title: "Unpaid Invoice Report" }, { extend: "excelHtml5", text: '<i class="fas fa-file-excel"></i> Excel', title: "Unpaid Invoice Report", sheetName: "Unpaid Invoice Report", messageTop: "Brillant Travel Account Management System, Unpaid Invoice Report" }, { extend: "pdfHtml5", title: "Unpaid Invoice Report", messageTop: "Brillant Travel Account Management System, Unpaid Invoice Report", orientation: "landscape", pageSize: "LEGAL" }] }), $(".dataTables_filter input").attr("placeholder", "Search Invoice Details"), $(".dataTables_filter input").addClass("form-control")) : ($("#myTable").DataTable({ bLengthChange: !1, orderCellsTop: !0, fixedHeader: !0, scrollCollapse: !0, searching: !1, scrollX: !0, scrollY: "50vh", processing: !0, language: { search: "", lengthMenu: "Select _MENU_ ", zeroRecords: "No <b>Invoice Details</b> Data Found", infoEmpty: "No Records Available", infoFiltered: "(filtered from _MAX_ total records)" } }), t = $("#reservation").val(), swal("INFO!", e.message + " for " + t, "info")) } $("#reservation").daterangepicker(), $(document).ready(function () { myDatatable() });