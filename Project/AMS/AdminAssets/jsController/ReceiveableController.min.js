function tableToExcel(e, t) { e.nodeType || (e = document.getElementById(e)); var a, o, l = { worksheet: t || "Worksheet", table: e.innerHTML }, e = document.createElement("a"); e.href = "data:application/vnd.ms-excel;base64," + (o = l, a = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>'.replace(/{(\w+)}/g, function (e, t) { return o[t] }), window.btoa(unescape(encodeURIComponent(a)))), e.download = t + ".xls", e.click() } function viewReport() { var e = $("#reservation").val(), t = e.substring(0, 10), a = e.substring(13), o = $("#ReceivePay_Status").val(), e = $("#Cust_Code").val(); null != o && "" != e ? $.ajax({ type: "POST", url: "/Receiveable/GetAllReceiveableByDate", data: { Dfrom: t, Dto: a, CustCode: e, status: o }, success: OnSuccess, failure: function (e) { alert(data.message) }, error: function (e) { alert(e.message) } }) : swal("Info!", "Select Customer & Received Status", "info") } function changeCust_Code(e) { $("#myTable").DataTable().destroy(); $("#ReceivePay_Status option:selected").text(); var t = $("#Cust_Code").val(), a = $("#ReceivePay_Status").val(); $.ajax({ type: "POST", url: "/Receiveable/GetAllReceiveable", data: { CustCode: t, status: a }, success: OnSuccess, failure: function (e) { alert(e.message) }, error: function (e) { alert(e.message) } }) } function changeReceivePay_Status(e) { $("#myTable").DataTable().destroy(); var t = $("#Cust_Code").val(); "" != e && "" != t && $.ajax({ type: "POST", url: "/Receiveable/GetAllReceiveable", data: { CustCode: t, status: e }, success: OnSuccess, failure: function (e) { alert(e.message) }, error: function (e) { alert(e.message) } }) } function toDayDate() { var e = new Date; return e.getDate() + "/" + ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"][e.getMonth()] + "/" + e.getFullYear() } function OnSuccess(e) { var t = $("#Cust_Code option:selected").text(); $("#myTable").DataTable().destroy(), $("table tbody").empty(), $("table thead").empty(), $("table tfoot").empty(), $("table thead").append("<tr><th>Invoice Number</th><th>Invoice Date</th><th>Ticket Number</th><th>Description</th><th>Routing</th><th>Amount</th><th>Paid</th><th>Balance</th></tr>"), $("table tfoot").append("<tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr>"), 1 == e.success ? 0 < e.r.length && ($("#Company_Name").text(e.r[0].Company_Name), $("#Contact_Name").text(e.r[0].Contact_Name), $("#Address").text(e.r[0].Address), $("#Phone").text(e.r[0].Phone), setTimeout(function () { swal.close() }, 1500), table = $("#myTable").DataTable({ data: e.r, columns: [{ data: "Invoice_Number", width: "200px" }, { title: "Invoice Date", width: "200px", data: "Invoice_Date", render: function (e) { return null == e ? "" : moment(e).format("DD/MMM/YYYY") } }, { data: "Ticket_Number", width: "200px" }, { data: "Description", width: "200px" }, { data: "Routing", width: "200px" }, { data: "Invoice_Amount", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Paid", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Balance", width: "200px", render: function (e) { return null == e ? "" : "$ " + e } }], paging: !1, select: !0, language: { search: "", searchPlaceholder: "Search Course" }, bLengthChange: !1, scrollY: "50vh", bScrollCollapse: !0, oLanguage: { sEmptyTable: "No data found" }, scrollX: !0, scrollCollapse: !0, autoWidth: !0, columnDefs: [{ width: "150px", targets: [0] }, { targets: [4], orderable: !1 }], footerCallback: function (e, t, a, o, l) { function r(e) { return "string" == typeof e ? +e.replace(/[\$,]/g, "") : "number" == typeof e ? e : 0 } var n = this.api(); amount = n.column(5, { page: "current" }).data().reduce(function (e, t) { return r(e) + r(t) }, 0), $(n.column(5).footer()).html("$ " + amount.toFixed(2)), paid = n.column(6, { page: "current" }).data().reduce(function (e, t) { return r(e) + r(t) }, 0), $(n.column(6).footer()).html("$ " + paid.toFixed(2)), balance = n.column(7, { page: "current" }).data().reduce(function (e, t) { return r(e) + r(t) }, 0), $(n.column(7).footer()).html("$ " + balance.toFixed(2)) } }), $(".dataTables_filter input").attr("placeholder", "Search Receiveable"), $(".dataTables_filter input").addClass("form-control"), $('<tr><th colspan="8" style="text-align:center; font-size:20pt; background: #748db9; color: ##022e7d;"><label>STATEMENT OF ACCOUNT</label></th>NaN').insertBefore("table > thead > tr:first"), $('<tr><th></th><th></th><th></th><th></th><th colspan="3"><label>Statement Date</label></th><th><label id="todayDate"></label></th>NaN').insertBefore("table > thead > tr:first"), $("<tr><th>Paid To</th><th>" + e.r[0].Company_Name + '</th><th></th><th></th><th colspan="3"><label>Code</label></th><th>' + t + "</th>NaN").insertBefore("table > thead > tr:first"), $('<tr><th colspan="5">Address: N 1781, Sur O’avenue Kapenda, Quarter Makutano, Commune et Ville de Lubumbashi</th><th></th><th colspan="2"><label>Email: admin@brillanttravel.com</label></th>NaN').insertBefore("table > thead > tr:first"), $('<tr><th colspan="8" style="height:60px"><img src="http://erpadmin.brillanttravel.com/Logo/logo.png" /></th>NaN').insertBefore("table > thead > tr:first")) : ($("#myTable").DataTable({ bLengthChange: !1, orderCellsTop: !0, fixedHeader: !0, scrollCollapse: !0, searching: !1, scrollX: !0, scrollY: "50vh", processing: !0, bDestroy: !0, paging: !1, info: !1 }), t = $("#reservation").val(), swal("INFO!", e.message + " for " + t, "info")) } $("#reservation").daterangepicker(), $(".select2").select2({ theme: "bootstrap4" });