function tableToExcel(e, t) { e.nodeType || (e = document.getElementById(e)); var a, s, l = { worksheet: t || "Worksheet", table: e.innerHTML }, e = document.createElement("a"); e.href = "data:application/vnd.ms-excel;base64," + (s = l, a = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>'.replace(/{(\w+)}/g, function (e, t) { return s[t] }), window.btoa(unescape(encodeURIComponent(a)))), e.download = t + ".xls", e.click() } function viewReport() { var e = $("#reservation").val(), t = e.substring(0, 10), e = e.substring(13); $.ajax({ type: "GET", url: "/ARSummary/GetARSummaryByDate", data: { Dfrom: t, Dto: e }, success: function (e) { 1 == e.success ? ($("#myTable").DataTable().destroy(), $("table tbody").empty(), table = $("#myTable").DataTable({ data: e.AR_Summary.Data, columns: [{ data: "Cust_Code" }, { data: "Debit" }, { data: "Credit", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Balance" }], fnCreatedRow: function (e, t, a) { 0 != t.Balance && ($(e).find("td:eq(0)").addClass("bg-success"), $(e).find("td:eq(1)").addClass("bg-success"), $(e).find("td:eq(2)").addClass("bg-success"), $(e).find("td:eq(3)").addClass("bg-success")) }, scrollX: !0, autoWidth: !0, paging: !1, select: !0, scrollY: "50vh", buttons: [{ extend: "copyHtml5", title: "AR Summary" }, { extend: "csvHtml5", title: "AR Summary" }, { extend: "excelHtml5", title: "AR Summary", text: "Excel", sheetName: "AR Summary", messageTop: "Brillant Travel Account Management System, AR Summary" }, { extend: "pdfHtml5", title: "AR Summary", messageTop: "Brillant Travel Account Management System, AR Summary", orientation: "portrait", pageSize: "A4" }], dom: "lBfrtip", language: { search: "" }, bLengthChange: !1, processing: !0, oLanguage: { sEmptyTable: "No <b>AR Summary</b> Data Found" } }), $(".dataTables_filter input").attr("placeholder", "Search AR Summary"), $(".dataTables_filter input").addClass("form-control")) : swal("INFO!", e.message, "info") } }) } var table; function myDatatable() { $.ajax({ type: "GET", url: "/ARSummary/GetARSummary", data: {}, success: function (e) { 1 == e.success ? (table = $("#myTable").DataTable({ data: e.AR_Summary.Data, columns: [{ data: "Cust_Code" }, { data: "Debit" }, { data: "Credit", render: function (e) { return null == e ? "" : "$ " + e } }, { data: "Balance" }], fnCreatedRow: function (e, t, a) { 0 != t.Balance && ($(e).find("td:eq(0)").addClass("bg-success"), $(e).find("td:eq(1)").addClass("bg-success"), $(e).find("td:eq(2)").addClass("bg-success"), $(e).find("td:eq(3)").addClass("bg-success")) }, scrollX: !0, autoWidth: !0, order: [[3, "asc"]], paging: !1, select: !0, scrollY: "50vh", buttons: [{ extend: "copyHtml5", title: "AR Summary" }, { extend: "csvHtml5", title: "AR Summary" }, { extend: "excelHtml5", title: "AR Summary", text: "Excel", sheetName: "AR Summary", messageTop: "Brillant Travel Account Management System, AR Summary" }, { extend: "pdfHtml5", title: "AR Summary", messageTop: "Brillant Travel Account Management System, AR Summary", orientation: "portrait", pageSize: "A4" }], dom: "lBfrtip", language: { search: "" }, bLengthChange: !1, processing: !0, oLanguage: { sEmptyTable: "No <b>AR Summary</b> Data Found" } }), $(".dataTables_filter input").attr("placeholder", "Search AR Summary"), $(".dataTables_filter input").addClass("form-control")) : swal("INFO!", e.message, "info") } }) } $("#reservation").daterangepicker(), $(document).ready(function () { $("#myTable tfoot th").each(function (e) { var t = $(this).text(); $(this).html('<input style="width:150px;" type="text" class="form-control" placeholder="Search ' + t + '" />'), $("input", this).on("keyup change clear", function () { table.column(e).search() !== this.value && table.column(e).search(this.value).draw() }) }), myDatatable() });